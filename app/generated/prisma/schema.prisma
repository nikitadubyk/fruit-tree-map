generator client {
  provider = "prisma-client-js"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum TreeStatus {
  pending
  approved
  rejected
}

enum UserRole {
  user
  admin
}

model Tree {
  id        Int        @id @default(autoincrement())
  latitude  Float
  longitude Float
  species   String
  note      String?
  createdAt DateTime   @default(now())
  status    TreeStatus @default(pending)

  approvedBy   User?     @relation("ApprovedTrees", fields: [approvedById], references: [id])
  approvedById Int?
  approvedAt   DateTime?

  creator   User? @relation("CreatedTrees", fields: [creatorId], references: [id])
  creatorId Int?
}

model User {
  id        Int      @id @default(autoincrement())
  name      String?
  email     String?  @unique
  createdAt DateTime @default(now())
  role      UserRole @default(user)

  createdTrees  Tree[] @relation("CreatedTrees")
  approvedTrees Tree[] @relation("ApprovedTrees")
}

model MagicLinkToken {
  id        Int      @id @default(autoincrement())
  token     String   @unique
  email     String
  createdAt DateTime @default(now())
  expiresAt DateTime
  used      Boolean  @default(false)
}
